"<s> In: What action should the robot take to {task}?\nOut: {simple_cot} {CotTag.ACTION.value} {action_str}</s>" prob=0.7
"<s> In: What action should the robot take to {task}?\nOut: </s>" prob=0.3

'In: What action should the robot take to pick up the spoon and put near the violet towel?\nOut: GRIPPER POSITION: [65, 82, 72, 80, 79, 82, 84, 82, 89, 83] ACTION: ක操과과尔ญŸ</s>'

input_ids
tensor([    1,   512, 29901,  1724,  3158,   881,   278, 19964,  2125,   304,
         5839,   701,   278,   805,  6150,   322,  1925,  2978,   278, 28008,
         1026,   304, 20466, 29973,    13,  3744, 29901,   402,  3960, 29925,
        13171,   349,  3267, 22122, 29901,   518, 29953, 29945, 29892, 29871,
        29947, 29906, 29892, 29871, 29955, 29906, 29892, 29871, 29947, 29900,
        29892, 29871, 29955, 29929, 29892, 29871, 29947, 29906, 29892, 29871,
        29947, 29946, 29892, 29871, 29947, 29906, 29892, 29871, 29947, 29929,
        29892, 29871, 29947, 29941, 29962,   319,  9838, 29901, 29871, 31865,
        31904, 31906, 31906, 31814, 31967, 31872,     2])

labels
tensor([ -100,  -100,  -100,  -100,  -100,  -100,  -100,  -100,  -100,  -100,
         -100,  -100,  -100,  -100,  -100,  -100,  -100,  -100,  -100,  -100,
         -100,  -100,  -100,  -100,  -100,  -100,  -100,   402,  3960, 29925,
        13171,   349,  3267, 22122, 29901,   518, 29953, 29945, 29892, 29871,
        29947, 29906, 29892, 29871, 29955, 29906, 29892, 29871, 29947, 29900,
        29892, 29871, 29955, 29929, 29892, 29871, 29947, 29906, 29892, 29871,
        29947, 29946, 29892, 29871, 29947, 29906, 29892, 29871, 29947, 29929,
        29892, 29871, 29947, 29941, 29962,   319,  9838, 29901, 29871, 31865,
        31904, 31906, 31906, 31814, 31967, 31872,     2])


'In: What action should the robot take to move the pot in the right side of the burner?\nOut: </s>'

input_ids
tensor([    1,   512, 29901,  1724,  3158,   881,   278, 19964,  2125,   304,
         4337,   278,  3104,   297,   278,  1492,  2625,   310,   278, 12138,
          261, 29973,    13,  3744, 29901, 29871,     2])
labels
tensor([ -100,  -100,  -100,  -100,  -100,  -100,  -100,  -100,  -100,  -100,
         -100,  -100,  -100,  -100,  -100,  -100,  -100,  -100,  -100,  -100,
         -100,  -100,  -100,  -100,  -100, 29871,     2])





Inference
input_ids
tensor([[    1,   512, 29901,  1724,  3158,   881,   278, 19964,  2125,   304,
          5096,   278,  7933,  2908,   373,   278, 13328,  2908, 29973,    13,
          3744, 29901]], device='cuda:0')
input_ids
tensor([[    1,   512, 29901,  1724,  3158,   881,   278, 19964,  2125,   304,
          5096,   278,  7933,  2908,   373,   278, 13328,  2908, 29973,    13,
          3744, 29901,   402,  3960, 29925, 13171,   349,  3267, 22122, 29901]],
       device='cuda:0')

generate

Langage: ['<s> In: What action should the robot take to stack the green block on the yellow block?\nOut: GRIPPER POSITION: [128, 80, 128, 80, 128, 89, 124, 92, 118, 89] ACTION: ', -0.007843137254901933, 0.007843137254901933, -0.47843137254901963, 0.0, 0.43137254901960786, 0.0, 0.996078431372549, '</s>']

print(seq_ids)
[1, 512, 29901, 1724, 3158, 881, 278, 19964, 2125, 304, 
5096, 278, 7933, 2908, 373, 278, 13328, 2908, 29973, 13, 
3744, 29901, 402, 3960, 29925, 13171, 349, 3267, 22122, 29901, 
518, 29896, 29906, 29947, 29892, 29871, 29947, 29900, 29892, 29871, 
29896, 29906, 29947, 29892, 29871, 29947, 29900, 29892, 29871, 29896, 
29906, 29947, 29892, 29871, 29947, 29929, 29892, 29871, 29896, 29906, 
29946, 29892, 29871, 29929, 29906, 29892, 29871, 29896, 29896, 29947, 
29892, 29871, 29947, 29929, 29962, 319, 9838, 29901, 29871, 31873, 
31871, 31933, 31872, 31817, 31872, 31744, 2]

prompt_out
'GRIPPER POSITION: [128, 80, 128, 80, 128, 89, 124, 92, 118, 89] ACTION: Έ論瀬Ÿ차Ÿ忠'


input_ids
tensor([[    1,   512, 29901,  1724,  3158,   881,   278, 19964,  2125,   304,
          5096,   278,  7933,  2908,   373,   278, 13328,  2908, 29973,    13,
          3744, 29901,   402,  3960, 29925, 13171,   349,  3267, 22122, 29901,
           518, 29896, 29906, 29947, 29892, 29871, 29947, 29900, 29892, 29871,
         29896, 29906, 29947, 29892, 29871, 29947, 29900, 29892, 29871, 29896,
         29906, 29947, 29892, 29871, 29947, 29929, 29892, 29871, 29896, 29906,
         29946, 29892, 29871, 29929, 29906, 29892, 29871, 29896, 29896, 29947,
         29892, 29871, 29947, 29929, 29962,   319,  9838, 29901, 29871, 31873,
         31871, 31933, 31872, 31817, 31872, 31744]], device='cuda:0')

output.sequences[0]
tensor([    1,   512, 29901,  1724,  3158,   881,   278, 19964,  2125,   304,
         5096,   278,  7933,  2908,   373,   278, 13328,  2908, 29973,    13,
         3744, 29901,   402,  3960, 29925, 13171,   349,  3267, 22122, 29901,
          518, 29896, 29906, 29947, 29892, 29871, 29947, 29900, 29892, 29871,
        29896, 29906, 29947, 29892, 29871, 29947, 29900, 29892, 29871, 29896,
        29906, 29947, 29892, 29871, 29947, 29929, 29892, 29871, 29896, 29906,
        29946, 29892, 29871, 29929, 29906, 29892, 29871, 29896, 29896, 29947,
        29892, 29871, 29947, 29929, 29962,   319,  9838, 29901, 29871, 31873,
        31871, 31933, 31872, 31817, 31872, 31744,     2],
       device='cuda:0')

Langage: ['<s> In: What action should the robot take to stack the green block on the yellow block?\nOut: GRIPPER POSITION: [128, 80, 128, 80, 128, 89, 124, 92, 118, 89] ACTION: ', -0.007843137254901933, 0.007843137254901933, -0.47843137254901963, 0.0, 0.43137254901960786, 0.0, 0.996078431372549, '</s>']
decoded_tokens
'<s> In: What action should the robot take to stack the green block on the yellow block?\nOut: GRIPPER POSITION: [128, 80, 128, 80, 128, 89, 124, 92, 118, 89] ACTION: Έ論瀬Ÿ차Ÿ忠</s>'
prompt_out
'GRIPPER POSITION: [128, 80, 128, 80, 128, 89, 124, 92, 118, 89] ACTION: Έ論瀬Ÿ차Ÿ忠'